(()=>{"use strict";var e,t={757:(e,t,a)=>{const r=window.wp.blocks,n=window.wp.i18n,o=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"spfa/sync-product-from-amazon","version":"1.0.0","title":"Sync Product From Amazon","category":"sync-product-from-amazon","icon":"cart","description":"This block will be used to retrieve data from Amazon using an ASIN number. It can fetch various Amazon product details such as price, sale price, CTA link, etc.","keywords":["amazon","product","price"],"supports":{"html":false},"textdomain":"sync-product-from-amazon","attributes":{"productDetails":{"type":"array","default":[]}},"editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./style-index.css","render":"file:./block.php"}'),c=window.React,s=window.wp.apiFetch;var m=a.n(s);const l=window.wp.element,i=window.wp.blockEditor,u=window.wp.components;(0,r.registerBlockType)(o,{edit:e=>{const{attributes:t,setAttributes:a}=e,{productDetails:r}=t,o=(0,i.useBlockProps)(),[s,d]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),[_,y]=(0,l.useState)(!1),[v,z]=(0,l.useState)(!1),[h,w]=(0,l.useState)(""),[E,g]=(0,l.useState)(!1),[N,b]=(0,l.useState)(2),k=()=>{b(E?2:r[0]?.features?.length||0),g(!E)},P=e=>/^[A-Z0-9]{10}$/.test(e);return(0,c.createElement)(c.Fragment,null,(0,c.createElement)("div",{...o},s?(0,c.createElement)("div",{className:"sync-product-from-amazon__loader"}):(0,c.createElement)("div",{className:"sync-product-from-amazon__container"},r&&(0,c.createElement)("div",{className:"sync-product-from-amazon__product"},r.map(((e,t)=>(0,c.createElement)("div",{key:t,className:"sync-product-from-amazon"},(0,c.createElement)("div",{className:"sync-product-from-amazon__left_wrapper"},(0,c.createElement)("div",{className:"sync-product-from-amazon__image"},(0,c.createElement)("img",{src:e.mediaURL,alt:e.title})),(0,c.createElement)("div",{className:"sync-product-from-amazon__details_wrap"},(0,c.createElement)("div",{className:"sync-product-from-amazon__price_detail"},(0,c.createElement)("div",{className:"sync-product-from-amazon__org_price"},(0,c.createElement)("span",null,e.price)),(0,c.createElement)("div",{className:"sync-product-from-amazon__sale_price"},(0,c.createElement)("span",null,e.salePrice))),(0,c.createElement)("a",{href:e.productURL,className:"sync-product-from-amazon__button"},(0,c.createElement)("span",{className:"sync-product-from-amazon__link"},(0,n.__)("View on Amazon","sync-product-from-amazon"))))),(0,c.createElement)("div",{className:"sync-product-from-amazon__content"},(0,c.createElement)("h4",{className:"sync-product-from-amazon__title"},e.title),(0,c.createElement)("div",{className:"sync-product-from-amazon__features"},(0,c.createElement)("ul",null,e.features.slice(0,N).map(((e,t)=>(0,c.createElement)("li",{key:t,className:"sync-product-from-amazon__feature_item"},e))),e.features.length>2&&(0,c.createElement)("a",{variant:"link",onClick:k,className:"sync-product-from-amazon__show-more sync-product-from-amazon__feature_item_show_more"},E?(0,n.__)("Show less","sync-product-from-amazon"):(0,n.__)("Show more","sync-product-from-amazon"))))))))),!r||0===r.length&&(0,c.createElement)("p",null,(0,n.__)("Please enter ASIN number and click on Fetch Product button to fetch product details.","sync-product-from-amazon")),p&&(0,c.createElement)("p",{className:"sync-product-from-amazon__error"},(0,n.__)("Product not found. Please enter valid ASIN number.","sync-product-from-amazon")))),(0,c.createElement)(i.InspectorControls,null,(0,c.createElement)(u.PanelBody,{title:(0,n.__)("Block Settings","sync-product-from-amazon"),initialOpen:!0},(0,c.createElement)(u.TextControl,{label:(0,n.__)("Enter ASIN Numberâ€¦","sync-product-from-amazon"),onChange:e=>{y(!1),P(e)&&z(!1),w(e)}}),_&&(0,c.createElement)("p",{className:"sync-product-from-amazon__error"},(0,n.__)("Please add ASIN number.","sync-product-from-amazon")),v&&(0,c.createElement)("p",{className:"sync-product-from-amazon__error"},(0,n.__)("Please enter valid ASIN number.","sync-product-from-amazon")),(0,c.createElement)(u.Button,{variant:"primary",onClick:()=>{(async e=>{if(e)if(P(e)){z(!1),d(!0);try{const t=await m()({path:"/sync-product-from-amazon/v1/fetch-product",method:"POST",data:{asin:e}});if(t.ItemsResult.Items&&t.ItemsResult.Items.length>0){const r=t.ItemsResult.Items.map((t=>{var a;const r=t.ItemInfo,n=t.Offers,o=t.Images,c=parseFloat(n.Listings[0].Price.Amount)+parseFloat(n.Listings[0].Price.Savings.Amount),s=null!==(a=n.Listings[0].Price.DisplayAmount.charAt(0))&&void 0!==a?a:0;return{title:r.Title.DisplayValue,mediaURL:o.Primary.Medium.URL,productURL:t.DetailPageURL,asin:e,features:r.Features.DisplayValues,price:s+c.toFixed(2),salePrice:n.Listings[0].Price.DisplayAmount,discountPercentage:n.Listings[0].PercentageSaved}}));a({productDetails:r})}else f(!0);d(!1)}catch(e){f(e?.message)}finally{d(!1)}}else z(!0);else y(!0)})(h)}},(0,n.__)("Fetch Product","sync-product-from-amazon")))))},save:function(){return null}})}},a={};function r(e){var n=a[e];if(void 0!==n)return n.exports;var o=a[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,a,n,o)=>{if(!a){var c=1/0;for(i=0;i<e.length;i++){a=e[i][0],n=e[i][1],o=e[i][2];for(var s=!0,m=0;m<a.length;m++)(!1&o||c>=o)&&Object.keys(r.O).every((e=>r.O[e](a[m])))?a.splice(m--,1):(s=!1,o<c&&(c=o));if(s){e.splice(i--,1);var l=n();void 0!==l&&(t=l)}}return t}o=o||0;for(var i=e.length;i>0&&e[i-1][2]>o;i--)e[i]=e[i-1];e[i]=[a,n,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={954:0,78:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var n,o,c=a[0],s=a[1],m=a[2],l=0;if(c.some((t=>0!==e[t]))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(m)var i=m(r)}for(t&&t(a);l<c.length;l++)o=c[l],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(i)},a=self.webpackChunksync_product_from_amazon_plugin=self.webpackChunksync_product_from_amazon_plugin||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var n=r.O(void 0,[78],(()=>r(757)));n=r.O(n)})();